# 이미지 분류

### 이미지 분류

---

컴퓨터 → 주어진 이미지를 보고 카테고리를 판단함.

→ 카테고리의 개수에 따라 **이진 분류, 다중 분류**로 나눌 수 있음.

지도 학습만 있는가? → 비지도학습/반지도학습으로도 이미지 분류가 가능함.

⇒ 이미지 분류라는 목표를 달성하기 위해…

### 이미지 활용

---

<aside>
🤖

카카오맵: 리뷰 이미지를 카테고리화해서 분류해놓음. CNN 모델을 이용함.

네이버: 스마트 렌즈를 통해 식물 검색할 수 있음.

</aside>

### 이미지 데이터 구조

---

**픽셀**(이미지를 구성하는 최소 단위, 하나의 색상값을 가짐)

많을수록 고해상도 이미지

**채널**(빛이 투과하는 통로): RGB는 각각의 채널을 가지며 어떤 채널을 통해 표현할 지 결정함.

**해상도**(이미지 크기, 가로 \* 세로를 픽셀 수로 표현함.)

이미지를 어떻게 숫자로 표현하는가? → 픽셀에 해당하는 숫자를 행렬로 배열함.

(그레이스케일 이미지 1채널, RGB 컬러 이미지 3채널)

### 기본적인 이미지 분류 접근 방식

---

- Raw-pixel을 이용한 비교

이미지의 픽셀 값을 직접 비교함. → 이미지를 같은 크기로 조정 후, 벡터 간 거리를 계산함.

⇒ 맨해튼 거리와 유클리디언 거리를 계산함. 채널 별로 따로 계산함.

### 선형 분류기

---

- 퍼셉트론 → 두 그룹을 가장 잘 나누는 선을 찾음.

**[선형 분류기]**

최적의 W와 b를 찾아나가는 과정. 각각의 확률값을 담은 값이 나오게 됨.

분류하려는 개수가 커질 수록 차원이 커짐. → 결과값이 N개가 나오게 됨.

- 점수가 큰 값으로 분류가 됨.

W는 각 분류 값을 만들기 위한 가중치 값. → 해당 값들을 그림으로 변경하면, 원래 분류하는 카테고리의 그림이 나오게 됨.

“파라미터적 접근” → 모든 데이터를 가중치화 해야 함. → 픽셀 사이의 유사성으로 점수를 매김.

→ 선형 분류기를 하나만 이용하면 템플릿이 하나로만 요약됨. → 다양한 블록을 쌓아야 함.

- 픽셀 기준으로 분류하므로 약간 가려지거나, 조금 이동해버린 사진은 비교할 수 없음.
- 시점이 달라짐에 따라 다른 사진으로 인식하게 됨.
- 밝기/채도 등 색에 따라 값이 달라지므로, 조명에 따라 달라지게 됨.
- 포즈가 달라지거나 일부가 가려질 경우에도 달라지게 됨.

⇒ 위 어려운 데이터셋에도 제대로 분류할 수 있는 강건한(Robust) 분류기를 만들어야 함.

### CNN (합성곱 신경망): Convolutional Neural Network

---

선형분류기 → 데이터를 1차원으로 펼쳐서 처리함.

⇒ CNN은 2차원 구조를 그대로 유지하여 분석함.

- FNN은 인접 픽셀 간의 상관관계를 무시해서 정보 손실 발생.

<aside>
🤖

**CNN**

- filter를 사용하여 feature map을 얻어냄.
- Convolution(+ 활성화 함수)과 Pooling 과정을 반복함.
</aside>

Convolution Layer: 입력에 다양한 필터를 적용하여 특징을 추출함.

(조금 작은 계산 필터를 통해 모든 공간에 돌려서, 조금 작은 크기로 변경시킴.)

활성화 함수가 없다면 → 여러 층이어도 하나의 선형 변환이 됨.

비선형 활성화 함수 → 각 층에서 더 복잡한 특징을 학습할 수 있도록 해줌.

Pooling Layer: feature map의 크기를 줄여 주는 역할.

- 가장 큰 값을 골라주는 Max-pooling과 평균을 뽑아내는 Average-Pooling이 존재함.
- 약간의 위치 변화에도 내성이 있음.

마지막 부분에 선형 분류를 진행해서 1차원이 되어버림. → 이미 고수준의 특징을 나타내도록 되어 있음.

- Softmax 함수: 네트워크 출력을 0부터 1사이의 확률 값으로 변경시킴.

> CNN에서는 어떤 부분을 학습하는가?

필터를 적용할 때마다 파라미터가 많아짐. (가로사이즈 _ 세로사이즈 _ 필터 개수)
